/* Performance optimizations for better INP scores */

/* Container isolation for complex layouts */
.container-wrapper,
.container-table-price-left,
.container-table-price-right,
.table-next-day-grid-left,
.table-next-day-grid-right {
  contain: layout style paint;
  will-change: contents;
}

/* Isolate chart containers to prevent layout recalculations */
.charts,
.line-chart-month-price,
.line-chart-day-price,
.line-chart-hour-price,
.line-chart-main-line-price {
  contain: layout style paint size;
  will-change: transform;
}

/* Table optimizations */
.table-same-day {
  contain: layout style paint;
  will-change: contents;
}

.tbody-same-day {
  contain: layout;
}

/* Navigation performance */
.site-header {
  contain: layout style paint;
  will-change: transform;
  transform: translateZ(0); /* Force GPU acceleration */
}

.nav-menu {
  contain: layout style;
}

/* Modal and overlay optimization */
.modal,
.tooltip,
.overlay {
  contain: layout style paint;
  will-change: opacity, transform;
}

/* Form elements optimization */
.form-file-container,
.datepicker-container {
  contain: layout style;
}

/* Price display elements */
.container-table-price-element {
  contain: layout style;
}

/* Optimize scrollable areas */
.scrollable-content {
  contain: layout style paint;
  overflow-anchor: none; /* Prevent scroll anchoring issues */
}

/* Footer optimization */
footer {
  contain: layout style paint;
}

/* Prevent layout shifts from dynamic content */
.container-max-min-avg {
  min-height: 60px;
  contain: layout;
}

.container-table-next-day-title {
  min-height: 40px;
  contain: layout;
}

/* Optimize animations and transitions */
@media (prefers-reduced-motion: no-preference) {
  .transition-optimized {
    transition-property: transform, opacity;
    transition-duration: 200ms;
    transition-timing-function: cubic-bezier(.4, 0, .2, 1);
    will-change: transform, opacity;
  }
}

/* Mobile-specific optimizations */
@media (max-width: 764px) {
  /* Reduce complexity on mobile */
  .charts {
    contain: layout style;
  }

  /* Optimize touch targets */
  button,
  .btn,
  .clickable {
    touch-action: manipulation; /* Prevent double-tap zoom delay */
  }

  /* Reduce paint areas on mobile */
  .container-wrapper {
    contain: layout;
  }
}

/* High performance selectors for frequently updated elements */
[data-dynamic-content] {
  contain: layout style;
  will-change: contents;
}

/* Optimize backdrop filters (expensive operation) */
.backdrop-blur {
  will-change: backdrop-filter;
  transform: translateZ(0);
}

/* Ensure smooth scrolling without impacting INP */
html {
  scroll-behavior: smooth;
  scroll-padding-top: 80px; /* Account for fixed header */
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
}

/* Optimize grid layouts */
.grid-container {
  contain: layout style paint;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
}

/* Loading states optimization */
.loading,
.skeleton {
  contain: layout style paint;
  will-change: opacity;
}

/* Prevent FOUC and layout shifts */
.no-fouc {
  visibility: visible !important;
}

/* ===== CLS FIX: Google Ads Responsive Container ===== */
/* Keeps ads responsive while preventing layout shifts */
.ad-wrapper-responsive {
  min-height: 280px;
  max-height: 600px;
  width: 100%;
  contain: layout style;
  margin: 1rem 0;
  position: relative;
  display: block;
}

/* Mobile-optimized ad space (98% of traffic) */
@media (max-width: 768px) {
  .ad-wrapper-responsive {
    min-height: 250px;
    max-height: 280px;
  }
}

/* Desktop ad space */
@media (min-width: 769px) {
  .ad-wrapper-responsive {
    min-height: 280px;
    max-height: 600px;
  }
}

/* Skeleton placeholder while ads load */
.ad-wrapper-responsive::before {
  content: '';
  display: block;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
  position: absolute;
  top: 0;
  left: 0;
  z-index: -1;
  border-radius: 4px;
}

/* Skeleton animation */
@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Ensure AdSense container inherits space reservation */
.ad-wrapper-responsive .adsbygoogle {
  display: block !important;
  min-height: 250px;
  width: 100%;
}

/* ===== INP OPTIMIZATION: Content-Visibility for Off-Screen Elements ===== */
/* Skips rendering cost for elements outside the viewport */
.price-table-wrapper,
.chart-container,
.blog-post-list,
.related-articles {
  contain: layout style paint;
  content-visibility: auto;
  contain-intrinsic-size: auto 500px; /* Placeholder height while off-screen */
}
